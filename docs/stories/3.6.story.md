# Story 3.6: URL快速访问

## Status
Done

## Story
**As a** 独立开发者,
**I want** 在项目卡片状态栏旁有一个相关链接入口,
**so that** 我可以快速访问和管理项目相关的URL资源

## Acceptance Criteria

### AC1: URL入口位置和显示逻辑
- URL入口[相关链接]按钮位于项目状态徽章（"进行中"/"已完成"）的同一行
- 按钮默认状态下隐藏（不可见）
- 鼠标移入项目卡片区域时，[相关链接]按钮显示

### AC2: 悬停交互行为  
- 鼠标移入[相关链接]按钮时显示下拉菜单/弹出框
- 展示当前保存的链接列表
- 无链接时显示"暂无链接"提示
- 菜单底部显示"添加链接"和"管理链接"选项

### AC3: 链接点击跳转功能
- 点击列表中的链接在新标签页中打开
- 点击后下拉菜单自动关闭

### AC4: 添加链接功能
- 点击"添加链接"显示简单输入框
- 用户可输入链接名称和URL
- 确认后保存到项目数据中
- **不需要URL格式验证**

### AC5: 删除链接功能  
- 链接项悬停或右键显示删除选项
- 确认删除后从项目数据中移除

## Tasks / Subtasks
- [x] 扩展Project数据模型 (AC1, AC4, AC5)
  - [x] 在Project接口添加`urls?: Array<{id: string, name: string, url: string}>`字段
  - [x] 更新类型定义文件`src/types/index.ts`
  - [x] 更新存储管理器处理URL数据
- [x] 实现ProjectCard组件URL入口功能 (AC1, AC2)
  - [x] 在状态徽章区域（252-255行）添加[相关链接]按钮
  - [x] 集成到现有isHovered状态逻辑中
  - [x] 实现悬停显示/隐藏动画效果
  - [x] 添加链接列表弹出框组件
- [x] 实现链接管理功能 (AC3, AC4, AC5)
  - [x] 实现链接点击新标签页跳转
  - [x] 创建添加链接对话框
  - [x] 实现删除链接确认功能
  - [x] 添加链接CRUD操作处理程序
- [x] 样式和交互优化 (All AC)
  - [x] 遵循现有shadcn/ui设计系统
  - [x] 实现平滑的悬停动画效果
  - [x] 确保移动端兼容性
- [x] 测试和验证 (All AC)
  - [x] 编写组件单元测试
  - [x] 测试链接CRUD操作
  - [x] 验证数据持久化功能

## Dev Notes

### 实现位置
**目标组件**: `src/components/ProjectCard.tsx`  
**具体位置**: 第252-255行状态徽章区域
```typescript
// 当前代码位置 (252-255行)
<div className="flex items-center gap-2 pt-1">
  <Badge variant="secondary" className={cn(project.isCompleted && "bg-success/15 text-success border-success/30")}>
    {project.isCompleted ? "已结束" : "进行中"}
  </Badge>
  <Badge variant="outline">{completed}/{project.todos.length} 已完成</Badge>
  {/* 在这里添加[相关链接]按钮 */}
</div>
```

### 数据模型扩展
**Project接口扩展**: `src/types/index.ts`
```typescript
interface Project {
  // ... 现有字段
  urls?: Array<{
    id: string;
    name: string; 
    url: string;
  }>;
}
```

### 现有资源复用
**可复用组件**:
- `Tooltip`, `TooltipContent`, `TooltipTrigger` - 已导入
- `Button` - 已导入  
- `Badge` - 已导入
- 需要新增: `Popover`, `PopoverContent`, `PopoverTrigger`

**现有状态**:
- `isHovered` - 可直接集成到现有悬停逻辑中
- 现有动画类: `expand-slide`, `transition-all`

### 技术约束
**必须遵循**:
- TypeScript严格类型检查
- shadcn/ui + Tailwind CSS设计系统
- 现有的悬停交互模式
- 不破坏现有拖拽功能

**排除功能**:
- ❌ URL格式验证
- ❌ 链接模板功能  
- ❌ 图标显示功能
- ❌ 复杂的URL管理界面

## Testing

### 测试策略
基于现有Vitest + Testing Library框架，需要为以下功能编写单元测试:

**组件交互测试**:
- [相关链接]按钮的显示/隐藏逻辑
- 悬停状态下弹出框的展示
- 链接点击跳转行为
- 添加/删除链接的用户交互

**数据管理测试**:
- Project模型的urls字段处理
- 链接CRUD操作的数据一致性
- 存储管理器的URL数据持久化

**验收测试用例**:
1. **视觉显示测试**: 验证按钮在正确位置且默认隐藏
2. **悬停显示测试**: 验证鼠标悬停时按钮显示和链接列表弹出  
3. **链接跳转测试**: 验证点击链接能在新标签页正确打开
4. **CRUD操作测试**: 验证添加、删除链接功能正常工作
5. **持久化测试**: 验证链接数据能正确保存和加载

**测试文件位置**: `src/__tests__/ProjectCard.test.tsx`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-14 | 1.0 | Initial story creation | Bob (Scrum Master) |
| 2025-08-15 | 2.0 | 重写story需求：移除URL验证和模板功能，专注于状态栏旁链接入口 | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
claude-sonnet-4-20250514

### Debug Log References
- TypeScript类型检查: 通过 ✓
- ESLint代码检查: 通过 ✓ (仅有UI组件相关警告，与功能无关)
- 单元测试: 28个测试全部通过 ✓
- 构建验证: 成功构建 ✓

### Completion Notes List
- ✅ 成功扩展Project数据模型，添加urls可选字段
- ✅ 在ProjectCard组件状态徽章旁添加相关链接按钮
- ✅ 实现悬停显示/隐藏动画效果，集成现有isHovered状态
- ✅ 使用Popover组件实现链接列表弹出框
- ✅ 实现链接CRUD操作：添加、删除、点击跳转功能
- ✅ 新标签页打开链接功能正常
- ✅ 添加了完整的单元测试覆盖
- ✅ 遵循shadcn/ui设计系统和现有代码风格
- ✅ 数据持久化功能自动兼容（由StorageManager处理）

### File List
- src/types/index.ts - 扩展Project接口添加urls字段
- src/components/ProjectCard.tsx - 实现URL快速访问功能
- src/__tests__/ProjectCard.test.tsx - 添加URL功能单元测试

## QA Results
*Results from QA Agent review will be populated here*